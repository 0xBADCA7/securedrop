---
# Testinfra vars file for app-staigng.
wanted_apache_headers:
  - 'Header edit Set-Cookie ^(.*)$ $1;HttpOnly'
  - 'Header always append X-Frame-Options: DENY'
  - 'Header set X-XSS-Protection: "1; mode=block"'
  - 'Header set X-Content-Type-Options: nosniff'
  - 'Header set X-Download-Options: noopen'
  - "Header set X-Content-Security-Policy: \"default-src 'self'\""
  - "Header set Content-Security-Policy: \"default-src 'self'\""
  - 'Header unset Etag'

securedrop_code: /var/www/securedrop
securedrop_data: /var/lib/securedrop
securedrop_user: www-data

app_hostname: app-staging
monitor_hostname: mon-staging

apache_listening_address: 0.0.0.0
apache_source_log: /var/log/apache2/source-error.log
apache_allow_from: all

mon_ip: 10.0.1.3
app_ip: 10.0.1.2

pip_deps:
  - name: 'Flask-Testing'
    version: '0.5.0'
  - name: 'mock'
    version: '2.0.0'
  - name: 'pytest'
    version: '3.0.3'
  - name: 'selenium'
    version: '2.53.6'

apparmor_complain:
  - "/usr/sbin/apache2"
  - "/usr/sbin/apache2//DEFAULT_URI"
  - "/usr/sbin/apache2//HANDLING_UNTRUSTED_INPUT"
  - "/usr/sbin/tor"

apparmor_enforce:
  - "/sbin/dhclient"
  - "/usr/lib/NetworkManager/nm-dhcp-client.action"
  - "/usr/lib/connman/scripts/dhclient-script"
  - "/usr/sbin/ntpd"
  - "/usr/sbin/tcpdump"
  - "system_tor"

app_directories:
  - /var/www/securedrop
  - /var/lib/securedrop
  - /var/lib/securedrop/store
  - /var/lib/securedrop/keys
  - /var/lib/securedrop/tmp

tor_services:
  - ssh
  - source
  - journalist

tor_stealth_services:
  - service: "HiddenServicePort 22 127.0.0.1:22"
    stealth: admin
  - service: "HiddenServicePort 80 127.0.0.1:8080"
    stealth: journalist
